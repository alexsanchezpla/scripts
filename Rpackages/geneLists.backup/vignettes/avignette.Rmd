---
title: "General Analysis of Gene Lists"
author: "Alex Sanchez"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

This document provides information on how to extract subsets of genes from previously available gene lists by setting different filtering conditions such as the fold change, the p-value or the availability of `Entrez` identifier.

##  Data Input Format for gene list selection}

In principle a filtering tool might read the file header and, once this is done, create an interactive dialog to query for the values that would be applied for subsetting the lists rows or columns.

In practice, and in our work environment most lists will be extracted from the standard output of our microarray analysis pipeline. (In this point we assume that the user is familiarized with standard microarray analysis ``a la Bioconductor''. If this is not so the reader can browse through the slides and examples in \url{http://eib.stat.ub.edu/Omics+Data+Analysis}). These files are generically described as "ExpressionAndTopTables" because they consist of tables having:
* The Gene Symbols and the Entrez Identifiers in the first two columns
* The standard output of the limma software known as "topTable"
* _(optionally)_ the Expression values that have been used to compute the Toptable. 

Although some type of analyses require only the gene identifiers other need also the expressions. For this reason these output files contain ``all that is needed'' for further analyses.

### Load example data

The simplest way to get the data is to load into an R object.

```{r loadData}
data(topTables)
class(AvsB)
colnames(AvsB)
head(AvsB[,1:7])
```

## Filtering genes

The functions available in the package allow to extract simple gene lists.

```{r filter1}
#' entrezs_01_up  <- genesFromTopTable (AvsB, entrezOnly = TRUE, uniqueIds=TRUE, adjOrrawP = "adj", Pcutoff = 0.01, updown="up", id2Select = "ENTREZ", FCcutoff=1, cols2Select =0) 
#' length(entrezs_01_up)
```

ALternatively one can extract a subtable consisting of several columns from the original table
```{r filter2}
#' table_01_up  <- genesFromTopTable (AvsB, entrezOnly = TRUE, uniqueIds=TRUE, adjOrrawP = "adj", Pcutoff = 0.01, updown="up", id2Select = NULL, FCcutoff=1, cols2Select =1:3) 
#' dim(table_01_up)
```


